from collections import defaultdict

# Sample data as lists of lists
job_levels = [[3.0, 2.0, 4.0, 1.0, 3.0],
              [float('nan'), 1.0, 3.0, 2.0, 4.0],
              [2.0, 3.0, 1.0, 4.0, 3.0]]
organizations = [['Marketing', 'Finance', 'HR', 'IT', 'Marketing'],
                 ['HR', 'Marketing', 'Finance', 'IT', 'HR'],
                 ['Finance', 'HR', 'Marketing', 'IT', 'Finance']]
employee_ids = [['EMP001', 'EMP002', 'EMP003', 'EMP004', 'EMP005'],
                ['EMP006', 'EMP007', 'EMP008', 'EMP009', 'EMP010'],
                ['EMP011', 'EMP012', 'EMP013', 'EMP014', 'EMP015']]
meeting_ids = [1, 1, 2, 2, 3]
meeting_dates = ['2024-04-28', '2024-04-28', '2024-04-29', '2024-04-29', '2024-04-30']

# Function to count the number of times each person was the most senior member in his organization for each meeting ID and date
def count_most_senior_in_organization(job_levels, organizations, employee_ids, meeting_ids, meeting_dates):
    senior_count_by_meeting = defaultdict(lambda: defaultdict(int))
    senior_count_overall = defaultdict(int)
    total_meetings_attended = defaultdict(int)
    max_levels = defaultdict(lambda: defaultdict(float))
    
    for job_level, organization, emp_id, meeting_id, meeting_date in zip(job_levels, organizations, employee_ids, meeting_ids, meeting_dates):
        for level, org, emp in zip(job_level, organization, emp_id):
            total_meetings_attended[emp] += 1
            if level > max_levels[(meeting_id, meeting_date)][org]:
                max_levels[(meeting_id, meeting_date)][org] = level
                senior_count_by_meeting[(meeting_id, meeting_date)][emp] = 1
                senior_count_overall[emp] += 1
            elif level == max_levels[(meeting_id, meeting_date)][org]:
                senior_count_by_meeting[(meeting_id, meeting_date)][emp] += 1
                senior_count_overall[emp] += 1
                
    return senior_count_by_meeting, senior_count_overall, total_meetings_attended

# Count the number of times each person was the most senior member in his organization for each meeting ID and date, overall, and total meetings attended
senior_count_by_meeting, senior_count_overall, total_meetings_attended = count_most_senior_in_organization(job_levels, organizations, employee_ids, meeting_ids, meeting_dates)

# Print the counts for each meeting ID and date
print("Senior count by meeting ID and date:")
for (meeting_id, meeting_date), count in senior_count_by_meeting.items():
    print(f"Meeting ID: {meeting_id}, Date: {meeting_date}, Senior count: {count}")

# Print the overall counts
print("\nOverall senior count:")
for emp, count in senior_count_overall.items():
    print(f"Employee ID: {emp}, Overall senior count: {count}")

# Print the total meetings attended by each person
print("\nTotal meetings attended:")
for emp, count in total_meetings_attended.items():
    print(f"Employee ID: {emp}, Total meetings attended: {count}")

# Calculate and print the ratio of being the most senior member in the organization to the total number of meetings attended
print("\nRatio of being the most senior member in the organization to total meetings attended:")
for emp in senior_count_overall.keys():
    ratio = senior_count_overall[emp] / total_meetings_attended[emp]
    print(f"Employee ID: {emp}, Ratio: {ratio:.2f}")
